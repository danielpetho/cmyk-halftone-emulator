<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>CMYK Halftone Printer Emulator</title>
  <link rel="stylesheet" href="./styles.css">
</head>
<body>
  <div class="container">
    <!-- Sidebar with controls -->
    <div class="sidebar">
      <div class="sidebar-content" id="controls">
        <!-- Blend Mode -->
        <div class="section">
          <div class="section-header">
            <span class="section-title">Blend Mode <span class="tooltip" data-tip="Subtractive: Traditional CMYK printing (dark inks on light paper). Additive: For light/neon inks on dark backgrounds. Normal: Most flexible, works with any color combination.">ⓘ</span></span>
          </div>
          <div class="section-content">
            <select id="blendMode">
              <option value="0">Subtractive (CMYK)</option>
              <option value="1">Additive</option>
              <option value="2">Normal (Alpha)</option>
            </select>
          </div>
        </div>
        
        <!-- Halftone Settings -->
        <div class="section">
          <div class="section-header">
            <span class="section-title">Halftone Settings</span>
          </div>
          <div class="section-content">
            <div class="control-row">
              <span class="control-label">Frequency <span class="tooltip" data-tip="Controls the density of halftone dots. Higher values = more dots.">ⓘ</span></span>
              <input type="range" id="frequency" min="5" max="400" value="85" step="1">
              <span class="control-value" id="frequency-val">85</span>
            </div>
            <div class="control-row">
              <span class="control-label">Dot Size <span class="tooltip" data-tip="Maximum size of halftone dots. Larger values = bigger dots.">ⓘ</span></span>
              <input type="range" id="dotSize" min="0.1" max="2" value="1" step="0.01">
              <span class="control-value" id="dotSize-val">1.00</span>
            </div>
            <div class="control-row">
              <span class="control-label">Roughness <span class="tooltip" data-tip="Adds irregular edges to dots for a more organic, vintage printing look.">ⓘ</span></span>
              <input type="range" id="roughness" min="0" max="5" value="2" step="0.1">
              <span class="control-value" id="roughness-val">2.0</span>
            </div>
            <div class="control-row">
              <span class="control-label">Fuzz <span class="tooltip" data-tip="Controls the softness of dot edges. Higher values create smoother transitions.">ⓘ</span></span>
              <input type="range" id="fuzz" min="0" max="0.5" value="0.1" step="0.01">
              <span class="control-value" id="fuzz-val">0.10</span>
            </div>
            <div class="control-row">
              <span class="control-label">Randomness <span class="tooltip" data-tip="Randomly shifts dot positions to break up regular grid patterns.">ⓘ</span></span>
              <input type="range" id="randomness" min="0" max="1" value="0.2" step="0.01">
              <span class="control-value" id="randomness-val">0.20</span>
            </div>
            <div class="control-row">
              <span class="control-label">Threshold <span class="tooltip" data-tip="Eliminates small dots below this value to remove artifacts. 0.05-0.15 recommended.">ⓘ</span></span>
              <input type="range" id="threshold" min="0" max="0.5" value="0.05" step="0.01">
              <span class="control-value" id="threshold-val">0.05</span>
            </div>
          </div>
        </div>
        
        <!-- Image Adjustments -->
        <div class="section">
          <div class="section-header">
            <span class="section-title">Image (Pre-filtering)</span>
          </div>
          <div class="section-content">
            <div class="control-row">
              <span class="control-label">Contrast <span class="tooltip" data-tip="Adjusts the tonal range of the image before halftone processing.">ⓘ</span></span>
              <input type="range" id="contrast" min="0.5" max="2" value="1" step="0.01">
              <span class="control-value" id="contrast-val">1.00</span>
            </div>
            <div class="control-row">
              <span class="control-label">Lightness <span class="tooltip" data-tip="Adjusts the overall brightness before halftone processing.">ⓘ</span></span>
              <input type="range" id="lightness" min="-0.5" max="0.5" value="0" step="0.01">
              <span class="control-value" id="lightness-val">0.00</span>
            </div>
            <div class="control-row">
              <span class="control-label">Blur <span class="tooltip" data-tip="Softens edges before halftone to reduce harsh cutoffs.">ⓘ</span></span>
              <input type="range" id="blur" min="0" max="5" value="1" step="0.1">
              <span class="control-value" id="blur-val">1.0</span>
            </div>
          </div>
        </div>
        
        <!-- Noise -->
        <div class="section">
          <div class="section-header">
            <span class="section-title">Noise & Texture</span>
          </div>
          <div class="section-content">
            <div class="control-row">
              <span class="control-label">Paper Noise <span class="tooltip" data-tip="Adds texture variation to the paper surface for a more realistic look.">ⓘ</span></span>
              <input type="range" id="paperNoise" min="0" max="1" value="0" step="0.01">
              <span class="control-value" id="paperNoise-val">0.00</span>
            </div>
            <div class="control-row">
              <span class="control-label">Ink Noise <span class="tooltip" data-tip="Simulates ink density variation for authentic printing imperfections.">ⓘ</span></span>
              <input type="range" id="inkNoise" min="0" max="1" value="0.6" step="0.01">
              <span class="control-value" id="inkNoise-val">0.60</span>
            </div>
          </div>
        </div>
        
        <!-- Screen Angles -->
        <div class="section">
          <div class="section-header">
            <span class="section-title">Screen Angles</span>
          </div>
          <div class="section-content">
            <div class="control-row">
              <span class="control-label">Cyan</span>
              <input type="range" id="cyanAngle" min="0" max="90" value="15" step="1">
              <span class="control-value" id="cyanAngle-val">15°</span>
            </div>
            <div class="control-row">
              <span class="control-label">Magenta</span>
              <input type="range" id="magentaAngle" min="0" max="90" value="75" step="1">
              <span class="control-value" id="magentaAngle-val">75°</span>
            </div>
            <div class="control-row">
              <span class="control-label">Yellow</span>
              <input type="range" id="yellowAngle" min="0" max="90" value="0" step="1">
              <span class="control-value" id="yellowAngle-val">0°</span>
            </div>
            <div class="control-row">
              <span class="control-label">Black</span>
              <input type="range" id="blackAngle" min="0" max="90" value="45" step="1">
              <span class="control-value" id="blackAngle-val">45°</span>
            </div>
          </div>
        </div>
        
        <!-- Ink Colors -->
        <div class="section">
          <div class="section-header">
            <span class="section-title">Ink Colors</span>
          </div>
          <div class="section-content">
            <!-- Cyan -->
            <div class="ink-group">
              <div class="ink-group-header">
                <div class="ink-dot" style="background: #00FFFF"></div>
                <span class="ink-name">Cyan</span>
                <input type="checkbox" class="checkbox" id="showCyan" checked>
              </div>
              <div class="color-row">
                <input type="color" id="cyanInk" value="#00FFFF" class="color-swatch">
                <input type="text" class="color-input" id="cyanInk-text" value="#00FFFF">
              </div>
              <div class="control-row">
                <span class="control-label">Alpha</span>
                <input type="range" id="cyanAlpha" min="0" max="1" value="0.95" step="0.01">
                <span class="control-value" id="cyanAlpha-val">0.95</span>
              </div>
            </div>
            
            <!-- Magenta -->
            <div class="ink-group">
              <div class="ink-group-header">
                <div class="ink-dot" style="background: #FF00FF"></div>
                <span class="ink-name">Magenta</span>
                <input type="checkbox" class="checkbox" id="showMagenta" checked>
              </div>
              <div class="color-row">
                <input type="color" id="magentaInk" value="#FF00FF" class="color-swatch">
                <input type="text" class="color-input" id="magentaInk-text" value="#FF00FF">
              </div>
              <div class="control-row">
                <span class="control-label">Alpha</span>
                <input type="range" id="magentaAlpha" min="0" max="1" value="0.95" step="0.01">
                <span class="control-value" id="magentaAlpha-val">0.95</span>
              </div>
            </div>
            
            <!-- Yellow -->
            <div class="ink-group">
              <div class="ink-group-header">
                <div class="ink-dot" style="background: #FFFF00"></div>
                <span class="ink-name">Yellow</span>
                <input type="checkbox" class="checkbox" id="showYellow" checked>
              </div>
              <div class="color-row">
                <input type="color" id="yellowInk" value="#FFFF00" class="color-swatch">
                <input type="text" class="color-input" id="yellowInk-text" value="#FFFF00">
              </div>
              <div class="control-row">
                <span class="control-label">Alpha</span>
                <input type="range" id="yellowAlpha" min="0" max="1" value="0.95" step="0.01">
                <span class="control-value" id="yellowAlpha-val">0.95</span>
              </div>
            </div>
            
            <!-- Black -->
            <div class="ink-group">
              <div class="ink-group-header">
                <div class="ink-dot" style="background: #000000; border: 1px solid #666"></div>
                <span class="ink-name">Black</span>
                <input type="checkbox" class="checkbox" id="showBlack" checked>
              </div>
              <div class="color-row">
                <input type="color" id="blackInk" value="#000000" class="color-swatch">
                <input type="text" class="color-input" id="blackInk-text" value="#000000">
              </div>
              <div class="control-row">
                <span class="control-label">Alpha</span>
                <input type="range" id="blackAlpha" min="0" max="1" value="0.95" step="0.01">
                <span class="control-value" id="blackAlpha-val">0.95</span>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Paper -->
        <div class="section">
          <div class="section-header">
            <span class="section-title">Paper / Background</span>
          </div>
          <div class="section-content">
            <div class="color-row">
              <input type="color" id="paperColor" value="#f8f4e8" class="color-swatch">
              <input type="text" class="color-input" id="paperColor-text" value="#f8f4e8">
            </div>
          </div>
        </div>
        
        <!-- Reset -->
        <div style="padding: 8px 0;">
          <button class="btn btn-secondary" style="width: 100%;" onclick="resetDefaults()">
            Reset to Defaults
          </button>
        </div>
      </div>
      
      <div class="sidebar-footer">
        <button class="btn btn-secondary" onclick="cancel()">Cancel</button>
        <button class="btn btn-primary" id="apply-btn" onclick="applyHalftone()">Apply</button>
      </div>
    </div>
    
    <!-- Main preview area -->
    <div class="main-area" id="main-area">
      <div class="empty-state" id="empty-state">
        <h2>Select an image</h2>
        <p>Select an image or a shape with an image fill in Figma to apply the halftone effect.</p>
      </div>
      
      <!-- Canvas container for zoom/pan -->
      <div class="canvas-container" id="canvas-container" style="display: none;">
        <div class="canvas-wrapper" id="canvas-wrapper">
          <canvas id="preview-canvas"></canvas>
        </div>
      </div>
      
      <!-- Zoom controls -->
      <div class="zoom-controls" id="zoom-controls" style="display: none;">
        <button class="zoom-btn" id="zoom-out" title="Zoom out">−</button>
        <span class="zoom-value" id="zoom-value">100%</span>
        <button class="zoom-btn" id="zoom-in" title="Zoom in">+</button>
        <div class="zoom-divider"></div>
        <button class="zoom-btn" id="zoom-fit" title="Fit to view">⊡</button>
      </div>
      
      <div class="loading" id="loading" style="display: none;">Processing...</div>
    </div>
  </div>
</body>
</html>

